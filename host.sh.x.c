#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f host.sh -o host 
#endif

static  char data [] = 
#define      text_z	5127
#define      text	((&data[950]))
	"\222\104\010\214\254\352\252\251\263\135\331\016\274\045\323\203"
	"\245\224\375\175\036\002\161\256\336\160\350\131\114\246\154\337"
	"\352\165\153\226\140\026\100\023\164\032\041\061\100\365\265\345"
	"\211\262\143\247\265\324\126\223\105\077\354\222\345\131\161\317"
	"\317\335\146\057\364\247\102\150\302\144\232\003\132\117\351\343"
	"\001\114\213\267\041\342\112\147\041\067\371\006\221\153\326\140"
	"\110\074\220\075\344\322\245\247\067\100\252\221\217\224\165\221"
	"\340\000\110\002\342\222\151\003\312\143\011\133\316\340\273\027"
	"\034\113\124\001\036\372\250\125\072\123\347\312\347\134\133\310"
	"\135\244\312\077\066\064\103\001\227\115\134\146\055\030\176\112"
	"\143\322\113\202\314\364\330\007\107\277\321\057\034\055\367\171"
	"\321\302\270\007\366\374\010\216\111\145\365\167\175\163\301\341"
	"\106\015\143\023\001\073\032\111\373\354\170\027\031\157\220\352"
	"\062\111\362\051\106\373\267\217\140\255\006\335\040\307\276\146"
	"\325\042\172\326\136\224\037\131\200\230\161\232\010\002\204\072"
	"\114\166\143\222\161\033\042\322\310\050\257\351\360\156\120\305"
	"\221\312\234\357\137\274\111\340\124\272\172\135\275\376\227\011"
	"\165\373\234\347\027\276\271\340\346\151\312\327\330\032\235\151"
	"\345\071\130\104\366\242\044\112\135\237\250\032\235\100\044\023"
	"\073\301\372\123\177\264\064\146\035\376\076\366\030\333\137\376"
	"\025\270\103\013\132\147\125\267\006\375\322\244\076\367\267\172"
	"\270\262\315\067\146\001\236\204\377\334\172\030\267\332\027\314"
	"\222\132\327\355\301\055\245\310\053\170\155\151\157\045\343\050"
	"\327\261\137\076\262\376\302\262\332\075\313\221\030\342\136\253"
	"\074\066\230\376\143\076\307\217\266\064\370\046\131\334\116\061"
	"\215\256\160\077\254\063\362\206\160\275\030\211\237\167\064\334"
	"\255\315\332\020\013\241\237\302\326\230\350\060\164\067\142\001"
	"\345\322\101\221\005\063\030\166\361\061\377\221\250\064\155\125"
	"\001\107\146\014\351\006\317\300\236\270\360\023\357\123\025\324"
	"\045\127\146\053\213\176\241\174\260\241\015\130\325\172\255\326"
	"\302\024\343\254\032\262\154\271\152\135\315\132\260\342\056\325"
	"\071\225\000\305\024\242\101\304\104\117\034\031\311\312\360\214"
	"\337\323\070\371\206\245\263\361\002\200\114\263\143\172\211\235"
	"\020\212\142\044\054\244\350\160\363\005\212\275\320\172\112\257"
	"\116\202\251\325\050\134\307\053\335\023\336\101\216\147\337\237"
	"\361\101\303\036\346\254\217\331\262\032\227\202\225\341\062\343"
	"\144\333\271\214\067\201\270\025\225\226\126\043\376\065\303\360"
	"\167\206\016\135\063\236\067\345\270\317\150\115\260\232\061\024"
	"\165\353\241\255\155\131\303\002\357\032\046\356\120\351\336\307"
	"\160\355\045\243\214\135\211\104\054\361\222\334\214\304\361\002"
	"\260\222\260\035\353\163\037\333\215\105\312\335\057\250\245\237"
	"\226\313\102\042\050\313\147\125\275\372\062\112\277\043\114\157"
	"\266\375\214\242\160\254\175\376\362\107\334\041\360\201\300\206"
	"\115\003\251\165\316\021\313\214\013\375\327\312\041\044\072\327"
	"\041\306\171\221\163\367\220\145\077\154\206\057\356\107\266\073"
	"\112\140\261\031\161\174\245\175\172\175\107\234\241\202\163\302"
	"\111\355\124\274\345\344\041\044\121\250\124\077\357\012\173\071"
	"\153\054\122\334\251\370\131\044\165\241\300\027\043\064\332\155"
	"\041\056\051\006\023\113\053\144\363\177\244\343\212\040\035\365"
	"\114\160\322\366\150\054\032\336\316\333\366\362\017\320\137\061"
	"\376\210\067\022\324\143\167\310\342\034\253\155\074\310\142\211"
	"\071\065\177\241\141\232\200\057\165\166\042\205\106\201\266\105"
	"\012\356\127\336\121\316\246\063\352\122\241\046\033\004\257\124"
	"\071\057\365\233\311\166\313\077\354\355\304\063\156\172\170\171"
	"\150\320\127\271\236\375\355\211\117\217\260\152\223\140\277\315"
	"\217\265\150\131\053\064\231\030\041\136\113\220\330\304\011\101"
	"\224\141\373\063\136\351\275\256\170\155\031\014\315\330\331\135"
	"\215\102\267\271\166\121\321\227\257\035\050\210\341\062\311\166"
	"\223\305\252\361\256\147\240\047\324\272\063\242\222\014\000\040"
	"\116\267\331\304\011\253\203\316\067\124\166\276\331\331\062\046"
	"\061\160\330\052\001\332\315\367\222\111\017\371\241\227\202\125"
	"\076\163\231\003\303\374\244\361\073\171\104\205\167\016\177\022"
	"\270\150\072\331\277\201\356\065\353\071\036\267\363\156\265\043"
	"\371\142\233\034\376\223\147\156\075\106\120\374\127\073\041\226"
	"\376\026\154\217\313\275\220\056\326\333\373\063\230\042\135\361"
	"\304\250\160\172\022\110\306\376\144\035\151\005\132\207\301\105"
	"\334\213\003\324\375\366\050\160\173\207\215\237\327\211\031\010"
	"\373\022\372\172\041\116\314\313\002\211\362\322\272\375\367\271"
	"\140\160\305\166\070\245\345\055\351\341\022\017\227\254\002\102"
	"\130\203\237\314\154\204\321\104\345\050\314\056\217\047\130\201"
	"\170\125\336\040\073\315\032\044\226\113\355\027\111\103\232\036"
	"\061\201\066\323\327\367\042\036\352\025\104\233\022\051\121\240"
	"\275\345\173\274\122\052\115\014\006\037\004\301\110\301\174\046"
	"\063\202\073\126\373\013\242\171\050\107\043\132\217\026\332\246"
	"\225\231\003\325\253\322\325\344\347\123\070\056\111\176\050\224"
	"\364\016\304\332\225\124\140\333\037\260\313\114\105\265\244\342"
	"\212\266\343\015\272\247\076\255\226\272\355\130\270\273\314\172"
	"\067\046\114\053\367\044\265\350\044\225\151\231\240\221\353\335"
	"\033\051\063\150\204\116\161\067\023\051\200\332\300\246\176\334"
	"\165\003\110\151\302\263\272\367\265\257\364\002\015\113\356\353"
	"\264\041\137\211\305\064\146\301\366\307\171\333\005\303\132\316"
	"\107\044\363\200\241\324\033\200\056\072\111\135\364\246\163\071"
	"\140\122\146\000\145\153\071\050\333\232\013\107\003\127\215\026"
	"\164\011\211\150\157\152\260\130\250\244\320\362\372\323\012\154"
	"\270\364\334\252\155\077\265\221\066\103\375\333\073\372\133\237"
	"\013\132\341\125\101\244\276\171\130\254\202\350\306\236\223\344"
	"\306\240\312\126\263\075\257\066\057\001\106\132\330\166\053\215"
	"\072\205\070\142\015\131\162\366\172\141\362\155\337\142\335\171"
	"\217\273\246\310\027\377\364\032\111\236\020\167\143\340\261\307"
	"\140\142\306\042\164\336\056\200\254\012\145\062\211\360\331\124"
	"\166\043\354\127\137\326\270\067\157\072\146\214\210\302\217\163"
	"\200\216\250\111\247\123\047\156\154\235\103\024\210\210\147\312"
	"\141\354\145\272\147\326\361\024\235\073\016\103\020\107\130\150"
	"\102\153\173\033\371\050\353\077\323\114\265\356\133\002\223\356"
	"\145\134\207\256\164\042\333\050\303\376\236\132\250\133\160\150"
	"\071\226\040\102\171\352\104\330\347\244\123\200\276\352\212\215"
	"\343\275\143\002\314\170\150\041\154\237\073\027\337\101\121\160"
	"\070\154\134\354\071\342\151\336\212\353\271\326\207\035\115\314"
	"\111\030\036\267\052\025\356\114\170\344\074\324\164\176\274\060"
	"\157\236\317\276\003\262\306\175\277\076\133\113\153\311\126\021"
	"\024\216\041\246\030\351\036\007\255\111\032\107\070\101\237\110"
	"\370\124\350\270\140\254\001\303\163\335\174\223\263\077\154\327"
	"\123\332\244\070\265\141\270\223\152\155\247\355\354\356\106\156"
	"\251\013\151\374\164\247\023\063\064\274\001\156\353\365\007\162"
	"\236\315\104\353\247\223\365\150\016\376\167\354\010\321\140\322"
	"\127\267\331\064\152\350\331\173\341\370\362\064\342\020\342\113"
	"\362\300\124\241\270\067\002\042\336\037\162\302\155\205\264\035"
	"\004\233\370\171\162\064\244\334\045\013\356\072\036\374\221\160"
	"\015\365\377\365\236\332\316\252\301\106\037\367\320\256\132\157"
	"\112\014\104\044\004\272\073\266\137\252\314\032\335\101\373\337"
	"\335\377\230\374\350\324\327\151\347\077\232\047\177\144\006\231"
	"\323\223\106\022\247\307\324\011\021\071\106\136\323\273\246\202"
	"\165\206\303\125\301\337\336\112\335\130\237\066\331\146\037\173"
	"\051\337\113\305\031\147\364\041\114\115\000\357\212\322\265\112"
	"\150\314\264\230\177\357\324\332\154\334\064\213\133\112\205\145"
	"\270\243\074\260\162\104\302\244\273\136\227\362\243\211\335\232"
	"\355\073\050\323\166\144\346\155\061\162\052\115\215\035\074\240"
	"\367\321\373\142\265\274\335\267\272\224\011\224\016\347\132\247"
	"\003\116\304\150\252\136\153\241\120\111\214\142\306\041\056\362"
	"\022\221\007\166\345\130\346\032\130\216\160\017\121\151\046\121"
	"\277\241\102\346\137\143\303\315\111\305\352\042\165\124\106\251"
	"\317\177\025\147\365\231\107\104\127\307\256\360\351\057\141\014"
	"\001\321\143\042\173\120\127\225\036\263\235\336\120\372\247\266"
	"\003\250\045\374\320\147\145\221\151\042\101\223\340\270\006\300"
	"\210\071\376\154\325\014\131\161\372\036\113\056\024\124\000\351"
	"\167\115\077\013\100\163\007\174\136\262\170\350\036\377\250\056"
	"\157\070\146\347\225\254\144\004\062\033\337\145\112\337\270\056"
	"\131\076\171\042\140\161\357\166\276\100\273\250\137\236\143\324"
	"\161\107\047\225\322\040\306\242\076\374\200\303\052\163\255\334"
	"\334\172\277\052\220\124\076\007\122\121\336\311\271\125\231\330"
	"\306\254\327\202\117\360\120\217\046\352\013\367\112\224\335\037"
	"\314\266\006\003\317\346\351\347\111\124\371\261\245\101\107\070"
	"\263\333\053\234\343\127\357\121\152\262\201\204\232\107\307\125"
	"\272\115\026\310\164\047\203\343\055\273\341\104\356\102\024\335"
	"\305\102\274\016\345\064\247\272\226\342\147\214\042\223\077\042"
	"\371\076\313\316\315\260\046\164\364\046\153\011\307\334\270\067"
	"\017\065\237\361\246\113\225\165\031\350\013\160\053\071\233\007"
	"\264\204\142\115\316\142\371\052\124\330\376\262\120\173\214\230"
	"\267\202\134\045\043\231\360\261\276\332\141\235\164\346\030\167"
	"\125\301\141\322\165\175\062\275\156\370\034\177\264\111\050\227"
	"\316\125\350\341\150\065\001\050\170\163\223\074\376\121\344\306"
	"\361\331\255\247\140\374\251\207\321\136\322\123\367\237\136\040"
	"\370\172\174\124\316\224\164\330\031\320\306\311\253\066\144\357"
	"\123\271\034\307\033\201\150\117\054\152\273\162\260\014\321\064"
	"\033\051\041\042\264\120\156\232\020\242\202\361\243\045\152\161"
	"\165\313\366\356\000\101\270\100\106\234\213\226\260\121\212\155"
	"\020\215\264\366\075\147\375\201\217\152\267\140\240\262\144\035"
	"\122\017\364\370\326\226\372\034\347\260\150\174\003\133\103\341"
	"\161\012\227\116\207\226\005\203\123\133\011\105\155\353\257\047"
	"\350\130\335\043\163\270\272\302\240\307\210\035\373\016\005\050"
	"\004\272\354\305\071\350\153\257\023\220\042\206\312\240\203\342"
	"\364\175\161\214\133\325\007\300\340\304\343\203\271\200\234\260"
	"\367\345\026\330\111\037\065\363\271\341\014\206\242\271\022\171"
	"\220\207\262\277\234\047\166\072\024\375\356\165\362\306\035\161"
	"\006\247\115\237\054\017\134\232\177\127\300\276\000\035\076\226"
	"\013\035\170\351\034\113\153\173\172\060\340\325\037\335\321\240"
	"\372\363\053\353\214\111\237\030\136\014\144\244\110\374\051\343"
	"\051\147\140\152\017\263\107\071\022\125\176\134\037\274\227\050"
	"\314\347\014\173\214\022\375\356\307\077\214\102\032\037\365\022"
	"\201\166\041\302\047\105\367\336\310\051\376\105\046\074\104\025"
	"\266\217\264\164\035\062\317\154\243\302\030\344\052\224\155\326"
	"\232\206\143\227\360\105\334\064\243\272\315\261\332\375\032\365"
	"\317\264\340\146\362\162\365\071\276\037\146\222\235\233\344\176"
	"\150\135\110\045\245\363\341\007\054\007\202\207\116\233\164\376"
	"\174\012\300\370\007\044\016\303\241\376\155\123\111\372\310\307"
	"\233\252\121\157\126\106\001\151\063\073\241\277\112\221\377\245"
	"\000\011\104\102\130\264\357\071\070\210\057\174\045\010\075\121"
	"\363\100\163\161\265\054\001\167\321\040\174\135\301\003\071\052"
	"\172\326\333\240\366\027\004\355\063\136\107\153\110\265\131\263"
	"\274\355\375\165\171\020\165\364\225\204\203\154\226\311\350\354"
	"\267\256\105\164\153\203\210\045\151\203\001\121\200\235\230\162"
	"\110\345\273\257\246\304\162\245\027\042\233\171\353\314\001\373"
	"\365\137\111\123\162\352\371\220\350\101\276\037\342\227\373\132"
	"\104\224\351\217\365\341\274\336\143\247\370\173\341\374\260\325"
	"\170\204\054\237\174\272\020\373\300\305\157\261\221\153\007\041"
	"\354\050\233\315\021\024\110\224\046\054\303\302\177\261\066\361"
	"\214\355\076\347\255\233\221\170\232\044\240\200\272\077\176\033"
	"\253\076\035\342\016\377\113\211\370\141\103\162\043\250\311\366"
	"\101\104\363\106\336\175\033\274\050\334\007\214\156\366\315\023"
	"\067\032\067\353\136\000\215\115\071\207\033\242\141\314\052\242"
	"\263\023\161\304\330\200\334\311\136\075\247\234\346\127\355\026"
	"\014\326\077\260\122\141\021\131\121\146\013\173\257\163\225\152"
	"\050\307\117\256\303\370\343\123\310\303\202\274\335\050\255\137"
	"\257\311\375\103\356\165\037\340\230\256\013\251\167\057\076\157"
	"\323\152\311\126\246\050\344\126\274\110\061\065\303\162\331\004"
	"\254\043\303\173\047\113\057\271\120\020\217\307\240\270\121\140"
	"\043\246\333\355\305\157\041\302\372\065\220\063\324\071\035\216"
	"\260\204\055\177\053\113\341\061\034\021\351\073\013\013\247\162"
	"\342\000\034\170\172\361\372\214\177\230\162\021\043\376\355\362"
	"\255\374\273\020\060\035\154\353\156\201\360\211\167\274\177\034"
	"\346\344\054\110\121\251\340\147\051\347\272\143\051\227\357\204"
	"\274\176\320\137\107\363\064\113\163\247\337\004\110\211\150\177"
	"\174\235\261\333\315\061\241\205\104\046\202\131\212\121\325\026"
	"\065\034\057\371\137\061\204\020\255\075\366\114\120\225\317\317"
	"\201\166\227\323\047\226\203\350\372\377\161\043\030\102\240\236"
	"\200\212\162\247\123\214\262\207\154\201\012\362\050\243\054\044"
	"\376\260\305\124\021\167\002\163\017\163\134\373\245\253\007\363"
	"\241\021\024\037\342\134\324\062\124\142\173\255\012\252\305\310"
	"\301\143\144\331\373\126\110\241\273\351\027\002\047\201\053\310"
	"\032\330\335\134\065\344\116\331\363\024\204\167\317\274\226\326"
	"\362\044\365\035\346\003\162\311\112\114\054\234\026\312\224\375"
	"\374\031\320\025\154\350\024\274\232\045\326\070\251\226\265\066"
	"\311\370\310\000\365\366\130\334\105\007\236\370\136\002\374\130"
	"\074\354\361\173\103\113\005\303\336\307\054\306\157\312\044\042"
	"\047\232\207\261\171\040\123\222\354\213\012\354\062\353\222\332"
	"\102\024\025\016\355\041\310\112\205\154\173\276\112\305\027\330"
	"\272\355\022\136\274\017\346\057\111\272\337\050\372\366\267\256"
	"\053\320\201\254\121\022\207\013\365\070\101\137\107\210\006\323"
	"\112\253\012\344\025\061\214\372\324\141\036\345\004\127\043\152"
	"\000\253\003\336\200\156\301\147\057\041\155\066\373\166\345\044"
	"\245\024\164\100\046\266\311\127\114\302\321\034\021\367\305\210"
	"\012\244\371\242\321\105\302\230\026\334\052\126\102\225\357\350"
	"\250\325\067\200\027\020\267\354\006\033\265\124\351\246\201\153"
	"\015\031\144\311\055\144\120\361\156\270\330\343\025\010\272\210"
	"\240\173\030\237\300\017\313\307\344\153\030\170\006\011\052\144"
	"\010\251\007\273\135\261\065\257\141\306\003\167\264\012\267\131"
	"\102\217\166\377\123\244\375\350\124\224\107\177\156\205\263\007"
	"\177\304\147\363\056\077\121\234\130\370\024\007\077\351\037\211"
	"\340\124\157\043\307\022\165\335\072\206\030\214\076\342\127\333"
	"\006\156\362\075\233\253\103\051\330\252\314\225\100\031\246\375"
	"\153\362\242\115\337\224\277\224\074\322\357\101\017\322\346\326"
	"\220\156\265\245\135\076\153\043\004\142\360\322\356\301\176\133"
	"\247\141\231\150\230\053\266\174\043\137\045\053\057\125\021\320"
	"\016\110\122\056\325\073\234\260\327\322\257\226\355\241\055\362"
	"\377\102\360\326\233\235\005\235\137\207\120\031\114\075\152\373"
	"\276\373\074\013\363\315\236\246\343\321\175\317\135\115\173\021"
	"\253\055\165\200\072\371\162\314\005\262\326\363\343\312\210\150"
	"\316\324\317\226\270\121\136\247\244\006\305\050\042\376\360\177"
	"\347\074\245\121\056\265\124\170\157\006\140\057\224\303\040\222"
	"\342\126\324\262\006\275\372\330\270\104\054\146\133\222\353\153"
	"\140\260\172\261\307\336\264\235\067\011\300\335\015\231\004\205"
	"\256\367\167\342\113\061\104\103\012\230\173\232\326\070\303\305"
	"\360\305\136\145\212\111\110\105\202\245\031\213\020\377\005\334"
	"\076\305\141\004\013\100\015\340\134\066\040\075\262\175\124\352"
	"\345\073\304\005\336\262\155\074\017\215\153\123\100\030\351\001"
	"\220\230\071\032\102\332\213\330\073\006\237\244\253\001\157\172"
	"\100\051\236\063\305\277\134\224\006\145\021\344\231\067\337\316"
	"\143\307\144\014\314\104\006\343\177\005\051\202\232\135\303\062"
	"\102\320\025\245\105\371\073\221\051\126\140\310\016\303\123\007"
	"\232\321\312\124\177\365\104\274\370\155\013\362\131\213\230\125"
	"\247\347\245\076\153\042\275\141\261\111\140\156\255\100\345\114"
	"\173\217\166\100\340\357\332\252\111\077\250\137\060\376\335\365"
	"\327\063\073\154\156\364\207\273\225\215\140\364\325\074\226\351"
	"\015\262\262\244\120\167\333\025\106\311\245\225\124\141\252\201"
	"\336\004\160\301\232\010\136\307\036\332\161\117\100\251\157\356"
	"\317\203\240\046\064\116\361\114\143\300\245\305\123\375\077\126"
	"\213\322\103\226\050\306\272\105\317\343\257\000\146\376\114\312"
	"\352\250\372\230\364\324\356\121\040\127\133\041\147\047\120\157"
	"\010\344\073\132\375\253\214\334\273\114\336\336\315\367\016\106"
	"\107\350\264\174\132\157\304\232\371\162\313\307\010\020\304\333"
	"\137\205\264\162\203\074\056\171\257\251\027\265\267\003\324\114"
	"\111\334\275\270\231\221\231\100\101\226\063\200\036\325\326\275"
	"\371\277\254\031\107\162\050\066\316\112\220\020\164\043\112\164"
	"\071\102\065\316\144\320\106\272\110\372\375\246\235\161\321\363"
	"\130\073\344\271\334\373\206\132\247\070\016\354\305\251\105\131"
	"\033\003\050\353\213\037\365\163\343\040\274\132\345\024\237\131"
	"\000\010\167\377\033\103\323\345\277\162\156\134\140\335\151\222"
	"\340\333\326\127\142\024\341\353\121\356\336\022\330\247\250\110"
	"\276\346\025\220\333\222\142\314\266\225\047\242\113\145\160\277"
	"\365\164\263\133\231\275\170\200\330\026\354\341\207\020\231\346"
	"\174\152\057\275\260\077\022\167\341\174\375\317\211\207\124\321"
	"\350\201\163\300\140\334\140\251\141\115\234\150\312\071\147\131"
	"\157\070\256\032\265\254\046\142\125\162\136\270\005\003\235\223"
	"\101\370\010\345\045\153\143\070\311\001\057\202\246\202\125\073"
	"\015\151\132\304\256\200\051\314\227\060\136\140\370\274\222\040"
	"\023\023\266\223\347\316\061\122\345\077\077\176\020\356\150\074"
	"\332\157\256\316\352\020\317\160\161\313\270\375\043\107\232\214"
	"\311\160\340\320\040\273\173\372\214\323\232\150\136\270\354\006"
	"\343\334\155\344\307\153\021\050\342\253\316\043\207\214\374\117"
	"\033\365\370\206\311\042\205\042\020\374\336\044\156\056\376\275"
	"\274\027\030\357\053\107\114\332\373\224\010\112\347\041\041\356"
	"\207\347\342\335\345\142\017\254\124\225\100\063\100\313\053\204"
	"\064\017\202\253\310\125\264\135\002\336\227\344\123\223\337\325"
	"\136\332\223\223\177\047\377\216\314\355\003\360\337\320\007\356"
	"\144\347\146\060\210\212\371\236\300\370\107\317\307\341\147\130"
	"\245\316\011\105\333\015\234\201\227\111\002\226\141\274\222\140"
	"\171\033\312\163\172\360\231\322\175\320\244\255\332\362\133\327"
	"\050\165\103\070\012\265\067\316\064\123\053\353\062\321\060\003"
	"\314\334\175\315\341\363\246\251\343\301\057\345\143\065\037\302"
	"\317\034\207\005\166\362\253\031\201\345\001\173\073\054\247\202"
	"\251\320\222\043\327\367\207\113\376\256\204\210\315\273\325\055"
	"\263\136\115\101\101\035\157\351\015\342\037\106\036\225\322\146"
	"\130\116\135\071\036\335\131\030\300\214\153\122\217\042\265\224"
	"\070\166\056\326\302\031\245\064\177\253\012\172\365\156\130\175"
	"\247\221\236\021\263\146\023\373\045\163\345\166\262\357\245\332"
	"\367\132\370\042\140\253\222\003\222\245\206\177\234\064\001\310"
	"\251\035\205\140\000\214\015\220\053\177\021\251\362\151\233\000"
	"\157\351\324\135\014\324\324\110\226\275\351\314\107\136\363\150"
	"\236\234\125\305\022\207\065\235\114\215\331\303\203\056\276\252"
	"\254\240\020\132\361\023\064\131\034\274\071\304\125\067\372\033"
	"\171\170\233\373\372\164\113\030\264\131\354\341\027\075\152\131"
	"\316\075\375\335\030\245\315\174\063\377\355\342\210\154\262\232"
	"\067\021\243\036\222\116\135\072\302\020\221\274\136\364\145\032"
	"\060\356\042\373\240\377\373\172\357\353\171\233\367\053\075\174"
	"\115\312\336\347\244\223\263\162\100\152\165\140\170\373\334\204"
	"\316\230\242\145\255\040\367\303\270\322\007\263\255\203\347\171"
	"\261\037\140\134\103\252\272\257\307\351\311\163\114\263\076\055"
	"\255\365\222\221\117\206\121\212\206\151\052\002\222\310\074\046"
	"\053\363\142\076\125\145\313\030\325\234\022\174\362\312\327\226"
	"\270\236\134\117\310\175\264\322\137\046\141\064\034\150\020\213"
	"\212\303\323\342\245\274\371\316\326\161\354\057\134\344\303\370"
	"\122\020\376\273\066\343\350\055\224\252\027\275\124\065\143\350"
	"\040\004\277\235\127\224\370\070\236\353\132\314\272\326\037\123"
	"\224\334\376\356\246\135\352\262\352\262\106\355\237\114\021\336"
	"\344\223\332\177\067\367\050\367\110\022\360\103\066\377\301\200"
	"\141\000\372\034\252\137\022\272\325\363\152\251\372\277\371\026"
	"\311\214\356\012\314\350\146\273\276\211\326\237\325\253\073\322"
	"\347\301\241\325\026\341\026\057\123\250\317\050\126\025\177\331"
	"\056\205\117\223\161\167\266\215\356\074\140\233\002\266\044\300"
	"\175\345\036\300\035\241\057\372\224\245\302\304\066\176\164\161"
	"\056\124\217\241\325\077\361\123\365\377\172\056\314\361\363\262"
	"\341\047\255\205\226\234\276\373\151\177\115\032\356\237\072\020"
	"\263\340\270\212\352\016\355\266\060\335\007\073\017\277\014\026"
	"\052\242\131\042\311\012\153\226\267\105\040\307\201\223\100\303"
	"\030\105\254\141\350\104\350\046\353\352\354\072\127\140\041\042"
	"\007\304\277\272\167\226\364\045\001\012\345\175\316\114\002\144"
	"\151\101\273\134\145\276\336\350\000\133\167\372\275\006\065\016"
	"\243\161\334\240\063\164\277\070\012\375\027\301\241\013\344\242"
	"\142\046\237\360\255\112\234\343\225\110\062\367\325\012\235\317"
	"\160\064\127\071\131\107\275\221\140\313\030\353\067\071\271\320"
	"\011\324\040\013\031\315\320\230\225\262\064\346\234\250\071\135"
	"\171\064\320\056\332\020\076\162\211\224\375\361\232\122\020\352"
	"\321\003\275\220\336\130\116\206\077\234\212\352\226\205\374\345"
	"\334\226\105\303\253\032\073\150\357\356\364\141\065\367\345\324"
	"\106\065\372\233\021\271\055\260\364\306\045\233\127\031\002\020"
	"\201\012\170\325\110\152\252\156\007\267\051\021\227\376\163\157"
	"\212\073\141\065\001\347\241\014\252\222\206\042\013\064\312\263"
	"\215\064\154\273\342\230\077\312\340\053\267\357\170\113\272\251"
	"\061\370\132\220\363\167\070\270\352\272\212\124\307\105\276\141"
	"\241\223\256\207\004\011\037\053\075\203\202\065\332\116\253\352"
	"\302\015\160\240\167\001\054\235\274\013\012\172\057\274\113\272"
	"\164\334\012\225\306\213\032\015\015\131\033\327\264\001\151\306"
	"\245\165\167\147\350\320\346\361\070\056\342\047\051\161\265\322"
	"\264\206\152\261\305\146\220\335\367\211\351\012\372\006\374\172"
	"\362\121\062\171\205\257\234\114\361\157\077\025\112\067\375\252"
	"\311\336\052\016\066\031\105\054\070\152\376\122\064\200\305\245"
	"\254\035\263\050\111\202\021\264\162\321\113\066\077\222\057\017"
	"\234\311\354\353\122\100\041\112\032\257\175\121\126\225\216\344"
	"\117\002\140\310\226\206\320\102\141\030\334\113\366\127\341\061"
	"\152\125\330\155\171\211\363\266\237\033\161\246\140\224\014\304"
	"\350\107\200\346\302\061\331\045\063\300\113\207\222\071\363\346"
	"\020\212\062\311\002\366\000\363\242\073\002\363\074\162\055\207"
	"\363\006\122\071\051\221\273\365\100\107\114\372\016\301\253\071"
	"\036\340\262\237\261\352\212\154\074\025\163\237\074\120\163\101"
	"\121\036\341\003\175\062\372\070\065\236\265\234\076\266\171\031"
	"\212\045\306\262\124\123\137\016\060\226\140\205\311\373\225\207"
	"\143\024\225\226\165\132\321\275\356\120\357\144\310\221\246\045"
	"\135\117\203\121\110\027\134\304\247\315\233\016\276\375\031\277"
	"\132\207\346\212\157\277\025\252\320\135\034\144\013\162\110\270"
	"\360\320\130\033\277\234\177\077\123\174\170\236\124\312\110\376"
	"\133\120\022\236\037\323\113\355\015\101\141\364\104\371\261\360"
	"\051\161\241\232\315\310\321\204\202\346\242\304\350\121\024\111"
	"\126\205\302\053\101\351\115\025\067\341\051\302\002\201\137\203"
	"\303\235\326\321\207\304\354\120\112\015\263\103\371\115\211\041"
	"\326\326\336\116\210\376\277\130\032\347\067\377\230\025\205\240"
	"\334\142\036\361\201\020\213\350\053\153\055\357\075\146\011\115"
	"\124\143\050\076\323\150\026\077\003\245\256\176\112\257\110\337"
	"\154\077\133\277\200\057\244\017\301\002\310\207\212\331\100\076"
	"\220\107\001\213\244\342\070\123\265\061\334\173\120\156\233\110"
	"\023\170\130\305\250\041\230\235\364\360\336\043\062\154\225\317"
	"\144\305\224\203\232\070\351\223\233\067\010\364\213\156\073\117"
	"\231\247\063\135\226\254\353\354\045\270\072\166\124\145\171\350"
	"\133\041\350\372\046\343\234\327\234\326\060\027\334\021\114\371"
	"\345\070\275\225\265\071\371\072\226\134\145\111\217\122\114\235"
	"\326\317\275\000\302\215\241\220\265\165\012\154\334\342\300\110"
	"\103\222\041\102\026\201\300\333\066\065\175\251\343\302\252\156"
	"\007\246\327\155\210\034\202\332\147\046\136\014\020\103\107\132"
	"\221\173\031\105\352\122\157\017\202\032\152\074\161\040\113\215"
	"\246\111\127\321\342\307\136\173\266\166\050\174\032\334\157\272"
	"\003\151\273\013\052\017\315\331\037\121\142\355\063\214\271\235"
	"\133\272\001\245\166\232\363\162\376\274\014\366\105\176\273\340"
	"\017\024\210\061\103\366\207\241\136\347\201\024\055\110\003\322"
	"\026\361\327\105\363\020\132\233\176\236\137\214\111\351\237\356"
	"\046\351\257\131\334\372\240\045\325\271\317\162\145\130\076\156"
	"\207\367\301\227\101\005\003\327\033\157\350\366\161\206\154\176"
	"\357\031\157\245\224\214\261\243\236\232\257\300\275\253\363\364"
	"\006\377\107\053\224\370\121\132\021\076\220\011\103\106\205\037"
	"\045\025\207\064\037\133\155\027\066\257\336\366\162\207\340\172"
	"\114\027\075\152\247\177\175\027\256\333\066\057\131\237\364\360"
	"\262\345\207\311\004\233\027\003\110\336\353\301\060\134\270\310"
	"\205\100\252\267\011\041\112\316\313\074\175\062\335\244\007\227"
	"\330\251\052\344\252\113\063\142\044\370\153\320\125\043\231\332"
	"\143\103\222\155\145\335\074\060\032\272\143\367\136\152\217\066"
	"\024\271\033\276\004\117\040\051\110\213\371\235\257\223\170\023"
	"\326\012\200\074\350\275\154\002\167\317\372\326\072\211\015\116"
	"\102\050\014\107\170\055\161\300\271\153\136\150"
#define      chk2_z	19
#define      chk2	((&data[6176]))
	"\325\341\374\021\365\175\331\373\273\365\107\075\342\110\236\220"
	"\202\021\072\364\015\347\303\311\271"
#define      tst1_z	22
#define      tst1	((&data[6201]))
	"\116\306\007\210\126\323\170\233\311\051\101\051\111\241\134\227"
	"\041\034\104\207\217\370\116\221\154\154\117"
#define      msg1_z	65
#define      msg1	((&data[6238]))
	"\075\342\332\266\020\113\166\311\267\324\061\265\253\255\235\042"
	"\042\040\013\272\005\131\150\374\042\220\144\051\145\144\056\240"
	"\000\152\056\340\142\001\013\222\015\002\007\047\360\215\124\144"
	"\235\326\176\052\321\246\140\367\374\054\217\155\347\155\360\044"
	"\110\153\215\206\321\212\065\035\122\155\035\201\127\323\313\212"
	"\214\251\234\126\143\032\042\224"
#define      lsto_z	1
#define      lsto	((&data[6312]))
	"\041"
#define      pswd_z	256
#define      pswd	((&data[6327]))
	"\307\313\357\252\246\245\272\361\034\203\251\361\264\136\241\014"
	"\314\261\222\211\203\270\026\275\311\154\007\106\105\132\361\227"
	"\066\231\044\364\215\271\276\272\004\317\175\022\130\036\037\045"
	"\320\262\257\124\153\305\021\064\062\031\172\167\163\153\017\251"
	"\005\063\235\222\355\134\115\361\053\313\004\204\352\043\251\272"
	"\326\131\016\101\036\040\165\120\071\357\307\255\133\327\126\140"
	"\012\364\363\367\120\101\351\174\014\355\001\366\021\253\261\347"
	"\004\300\051\042\340\236\163\032\216\073\307\351\022\036\112\034"
	"\023\076\024\143\177\375\340\214\353\341\202\375\215\063\344\221"
	"\364\016\263\324\254\047\357\073\142\266\045\164\325\157\221\350"
	"\256\246\114\055\244\055\271\217\017\074\215\234\160\161\055\144"
	"\177\341\070\054\010\047\147\152\336\214\337\264\374\161\234\252"
	"\027\351\327\273\026\221\113\046\315\330\302\075\112\357\242\312"
	"\321\332\366\331\002\136\104\341\353\043\225\347\224\062\222\254"
	"\034\152\147\063\373\263\131\311\213\033\006\325\013\251\240\334"
	"\203\227\266\206\365\372\150\341\036\375\311\262\057\133\137\114"
	"\305\306\177\300\171\330\211\005\363\220\333\377\071\173\234\141"
	"\351\051\013\205\200\156\240\243\003\011\214\240\371\305\122\301"
	"\221\101\153\067\347\045\051\003\250\322\365\135\061\222\277\032"
	"\273\312\240\074\071\100\337\075\111\154\336"
#define      shll_z	41
#define      shll	((&data[6630]))
	"\004\303\272\234\220\243\150\041\151\031\061\264\053\325\231\002"
	"\105\255\332\034\251\261\067\354\364\334\123\201\005\160\310\324"
	"\032\343\260\130\257\372\105\027\371\243\140\162\160"
#define      date_z	1
#define      date	((&data[6673]))
	"\054"
#define      inlo_z	3
#define      inlo	((&data[6674]))
	"\335\002\230"
#define      xecc_z	15
#define      xecc	((&data[6678]))
	"\050\307\050\113\364\347\343\223\246\026\011\127\363\271\345\171"
	"\344\133"
#define      chk1_z	22
#define      chk1	((&data[6698]))
	"\343\334\140\343\001\350\067\002\272\326\171\134\070\217\043\012"
	"\351\120\050\077\336\111\142\255\354"
#define      msg2_z	19
#define      msg2	((&data[6723]))
	"\155\050\174\273\144\314\050\367\207\041\012\165\162\350\163\224"
	"\216\333\207\336\052\341\261\133\254"
#define      rlax_z	1
#define      rlax	((&data[6745]))
	"\322"
#define      opts_z	1
#define      opts	((&data[6746]))
	"\307"
#define      tst2_z	19
#define      tst2	((&data[6748]))
	"\372\117\173\027\366\214\332\022\074\202\320\270\025\221\277\136"
	"\255\173\016\221\066\050\226\136"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * clang -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/data/data/com.termux/files/usr/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "clang";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/data/data/com.termux/files/usr/tmp/shc_x.so", "/data/data/com.termux/files/usr/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return -1;}
	remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/data/data/com.termux/files/usr/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/data/data/com.termux/files/usr/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
